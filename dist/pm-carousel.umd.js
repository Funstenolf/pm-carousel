var __assign=Object.assign;!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self)["pm-carousel"]=e()}(this,(function(){"use strict";const t="data-pm-carousel",e=`${t}-paging`,s=`${t}-wrapper`,i=`${t}-overflow`,n=`${t}-item`,o=`${t}-prev`,h=`${t}-next`,a=`${t}-playstop`,r="transform .5s ease-in-out",l="is-active";var c={extend:function t(){const e={};let s=!1,i=0;const n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(s=arguments[0],i++);const o=function(i){for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&(s&&"[object Object]"===Object.prototype.toString.call(i[n])?e[n]=t(!0,e[n],i[n]):e[n]=i[n])};for(;i<n;i++){o(arguments[i])}return e},returnJson:function(t){try{return JSON.parse(t)}catch(e){return{}}}};const d={playstop:function(){this.nodes.playstop&&(this.nodes.playstop.hidden=!this.config.autoplay)},wrappers:function(){const t=this.config.noStartSpace?0:this.config.spaceAround;this.nodes.overflow.style.transform=`translateX(${-100*this.active+t}%)`,this.config.noStartSpace?this.nodes.overflow.style.paddingRight=this.config.spaceAround+"%":(this.nodes.overflow.style.paddingRight=t+"%",this.nodes.overflow.style.paddingLeft=t+"%"),this.nodes.overflow.style.transition=r,this.nodes.overflow.style.display="flex",this.nodes.wrapper.style.overflow="hidden",this.el.classList.add(l)},slides:function(){const e=[];for(this.nodes.items.forEach(((e,s)=>{e.setAttribute("tabindex","-1"),e.setAttribute(t+"-item",s),e.style.flex=`1 0 ${100/this.config.group}%`,e.style.overflow="hidden"}));this.nodes.items.length>0;)e.push(this.nodes.items.splice(0,this.config.group));this.nodes.items=e,this.slideLength=this.nodes.items.length},paging:function(){if(!this.nodes.paging)return;let t,e;const s=document.createDocumentFragment();this.nodes.paging.innerHTML="",this.nodes.pages=[],this.nodes.items.forEach(((i,n)=>{e=this.pagingBtnString,t=document.createElement("div"),t.innerHTML=e.replace("{nbr}",++n),this.nodes.pages.push(t.firstElementChild),s.appendChild(t.firstElementChild)})),this.nodes.paging.append(s),this.nodes.paging.hidden=!1}};function p(t=[]){t.forEach((t=>d[t].call(this)))}function u(){this.nodes={paging:this.el.querySelector(`[${e}]`),wrapper:this.el.querySelector(`[${s}]`),overflow:this.el.querySelector(`[${i}]`),items:[].slice.call(this.el.querySelectorAll(`[${n}]`)),prev:this.el.querySelector(`[${o}]`),next:this.el.querySelector(`[${h}]`),playstop:this.el.querySelector(`[${a}]`)},this.active=0,this._interval=null,this.autoplayStatus="stop",this._slideWidth=0,this._touchstartX=0,this._touchmoveX=0,this._moveX=0,p.call(this,["slides","wrappers","playstop","paging"]),this.el.addEventListener("click",this.onClick),this.el.addEventListener("keydown",this.onKeydown),this.nodes.wrapper.addEventListener("touchstart",this.onTouchStart),this.nodes.wrapper.addEventListener("touchmove",this.onTouchMove),this.nodes.wrapper.addEventListener("touchend",this.onTouchEnd),this.config.autoplay>1&&this.nodes.playstop?(this.config.loop=!0,this.autoplayStatus="play",this.play(),this.el.addEventListener("mouseenter",this.pause.bind(this)),this.el.addEventListener("mouseleave",this.play.bind(this))):this.changeActive(this.active)}function g(){this._slideWidth=this.activeSlides[0].offsetWidth*this.config.group,this._distance=this.active*this._slideWidth,this.active===this.slideLength-1&&(this._distance=this.nodes.overflow.scrollWidth-this._slideWidth,this.config.spaceAround&&(this._distance-=parseInt(window.getComputedStyle(this.nodes.overflow).getPropertyValue("padding-right"),10))),this.nodes.overflow.style.transform=`translateX(${-this._distance}px`}function v(){if(!this.nodes.prev)return;const t=this.prevString;this.nodes.prev.innerHTML=t.replace("{text}",0===this.active?this.texts.prevFirst:this.texts.prev),this.config.loop?this.nodes.prev.hidden=!1:this.nodes.prev.hidden=0===this.active}function f(){if(!this.nodes.next)return;const t=this.nextString;this.nodes.next.innerHTML=t.replace("{text}",this.active===this.slideLength-1?this.texts.nextLast:this.texts.next),this.config.loop?this.nodes.next.hidden=!1:this.nodes.next.hidden=this.active===this.slideLength-1}function y(){this.activeSlides=[],this.nodes.paging&&this.nodes.pages.forEach(((t,e)=>{let s=t;const i=t.querySelector("button");i&&(s=i),e===this.active?(s.setAttribute("aria-current","true"),t.classList.add(l)):(s.removeAttribute("aria-current"),t.classList.remove(l))})),this.nodes.items.forEach(((t,e)=>{t.forEach(((t,s)=>{e===this.active?(0===s&&"play"!==this.autoplayStatus&&t.focus({preventScroll:!0}),t.setAttribute("aria-hidden","false"),this.activeSlides.push(t)):t.setAttribute("aria-hidden","true")}))})),g.call(this),v.call(this),f.call(this)}function m(e){let s=this.active;const i=e.target,n=i.closest(`[${t}-playstop]`),o=i.closest(`[${t}-prev]`),h=i.closest(`[${t}-next]`),a=i.closest(`[${t}-paging]`);if(n)this.toggleAutoplay();else{if(o)s--;else if(h)s++;else{if(!a||!a.querySelector("button"))return;{const e=i.closest(`[${t}-paging] li`);s=this.nodes.pages.indexOf(e)}}this.stop(),this.changeActive(s)}}function w(t){let e=!1;switch(console.log(t.key),t.key){case"ArrowUp":case"ArrowLeft":e=!0,this.changeActive(this.active-1);break;case"ArrowDown":case"ArrowRight":e=!0,this.changeActive(this.active+1);break;case"Home":e=!0,this.changeActive(0);break;case"End":e=!0,this.changeActive(this.slideLength-1)}e&&t.preventDefault()}var S={onTouchStart:function(t){this.nodes.overflow.style.transition="none",this._touchstartX=Math.round(t.touches[0].pageX),this._slideWidth=this.nodes.wrapper.offsetWidth},onTouchMove:function(t){this._touchmoveX=Math.round(t.touches[0].pageX),this._moveX=this._touchstartX-this._touchmoveX,this.nodes.overflow.style.transform=`translateX(${-this._distance-this._moveX/2}px)`},onTouchEnd:function(t){let e=this.active;if(this.nodes.overflow.style.transition=r,this._moveX>this._slideWidth/3)e++;else{if(!(this._moveX<-this._slideWidth/3))return void(this.nodes.overflow.style.transform=`translateX(${-this._distance}px)`);e--}this.changeActive(e)}};function b(){const t=this.settings.responsive.slice().reverse().find((t=>window.matchMedia(`(min-width: ${t.minWidth})`).matches));return t?__assign(__assign({},this.settings.default),t):this.settings.default}let x,L=!1;function _(){L||(L=!0,x=setTimeout((()=>{this.config=b.call(this),this.config.disable?this.disable():this.reinit(),L=!1,clearTimeout(x)}),500))}const A={default:{loop:!0,group:1,spaceAround:0,noStartSpace:!1,autoplay:0}};class E{constructor(s,i){this.el=s;const n=c.returnJson(this.el.getAttribute(t));if(this.settings=c.extend(!0,A,i,n),this.config=this.settings.default,this.settings.responsive&&(this.settings.responsive.sort(((t,e)=>parseInt(t.minWidth,10)-parseInt(e.minWidth,10))),this.config=b.call(this),this.settings.responsive.forEach((t=>{window.matchMedia(`(min-width: ${t.minWidth})`).addEventListener("change",_.bind(this))}))),this.onClick=m.bind(this),this.onTouchstart=S.onTouchStart.bind(this),this.onTouchMove=S.onTouchMove.bind(this),this.onTouchEnd=S.onTouchEnd.bind(this),this.onKeydown=w.bind(this),this.nodes={paging:this.el.querySelector(`[${e}]`),prev:this.el.querySelector(`[${o}]`),next:this.el.querySelector(`[${h}]`),playstop:this.el.querySelector(`[${a}]`)},this.nodes.paging&&(this.pagingBtnString=this.nodes.paging.innerHTML),this.texts={},this.nodes.playstop){this.playstopString=this.nodes.playstop.innerHTML;const t=this.nodes.playstop.getAttribute(a).split("|");this.texts=__assign(__assign({},this.texts),{play:t[0],stop:t[1]})}if(this.nodes.prev&&this.nodes.next){this.prevString=this.nodes.prev.innerHTML,this.nextString=this.nodes.next.innerHTML;const t=this.nodes.prev.getAttribute(o).split("|"),e=this.nodes.next.getAttribute(h).split("|");this.texts=__assign(__assign({},this.texts),{prev:t[0],prevFirst:t[1],next:e[0],nextLast:e[1]})}this.config.disable||u.call(this)}reinit(){u.call(this)}play(){if(!this.nodes.playstop||"stop"===this.autoplayStatus)return;this.pause(),this.autoplayStatus="play",this.nodes.playstop.classList.add("is-playing");const t=this.playstopString;this.nodes.playstop.innerHTML=t.replace("{text}",this.texts.play);let e=this.active;this._interval=window.setInterval((()=>{e++,e>this.slideLength-1&&(e=0),this.changeActive(e)}),this.config.autoplay)}pause(){window.clearInterval(this._interval)}stop(){if(!this.nodes.playstop)return;this.autoplayStatus="stop",this.nodes.playstop.classList.remove("is-playing");const t=this.playstopString;this.nodes.playstop.innerHTML=t.replace("{text}",this.texts.stop),window.clearInterval(this._interval)}toggleAutoplay(){this.nodes.playstop&&("play"===this.autoplayStatus?this.stop():"stop"===this.autoplayStatus&&(this.autoplayStatus="play",this.play()))}changeActive(t){this.active=t,this.active<0&&(this.active=this.config.loop?this.slideLength-1:0),this.active>this.slideLength-1&&(this.active=this.config.loop?0:this.slideLength-1),y.call(this)}disable(){this.stop(),this.nodes.wrapper.removeEventListener("touchstart",this.onTouchStart),this.nodes.wrapper.removeEventListener("touchmove",this.onTouchMove),this.nodes.wrapper.removeEventListener("touchend",this.onTouchEnd),this.el.removeEventListener("click",this.onClick),this.el.removeEventListener("mouseenter",this.pause),this.el.removeEventListener("mouseleave",this.play),this.nodes.paging.hidden=!0,this.nodes.prev.hidden=!0,this.nodes.next.hidden=!0,this.nodes.playstop.hidden=!0,this.nodes.overflow.removeAttribute("style"),this.nodes.wrapper.removeAttribute("style"),this.nodes.items.forEach((t=>{t.forEach((t=>{t.removeAttribute("tabindex"),t.removeAttribute("aria-hidden"),t.removeAttribute("style")}))})),this.el.classList.remove(l)}}const $=(e,s)=>{!e.pmCarousel&&e.hasAttribute(t)&&(e.pmCarousel=new E(e,s))},T=function(e={},s){null!==s&&((s=s||document.querySelectorAll(`[${t}]`)).length?s.forEach((t=>$(t,e))):$(s,e))};return window.pmCarousel=T,T}));
